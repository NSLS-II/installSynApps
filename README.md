# installSynApps

A collection of scripts meant to install all of epics and synApps with one command

### Auto Build

For most purposes, it is simplest to run the auto-build script, which will give you a guided process through building the modules.
To do this, run:
```
./auto_build.sh
```
The script will first ask if you wish to keep the default build config, which in most cases is yes. Next, it will ask if
the curret install location is OK. If no, simply enter the new install location.

### Included scripts

Script name                    | Script Function
------------------- | ------------------------------------------------------
auto_build.sh | Recommended script that gives a guided build process
installSynApps.sh | top level bash script that runs the remaining scripts sequentially
clone_and_checkout.py | Clones all required repositories and checks out correct versions
read_install_config.py | Script that reads the data in the INSTALL_CONFIG file
update_release_file.py | Script that updates the release files in support and area detector
ad_config_setup.py | Script based on adConfigSetup, that replaces area detector configuration files
dependencyInstall.sh | bash script that installs all required packages for EPICS and synApps
script_generator.py | script that creates bash scripts for installing and uninstalling, so that compilation for other operating systems is simplified.


### Included Configuration files

Configuration file      | Use 
-------------------------|--------------------
INSTALL_CONFIG      | The main configuration file for installSynApps. Use this file to decide which modules to clone and build
AD_RELEASE_CONFIG   | Adds paths to external plugins developed for area detector into the area detector build process.
MAKEFILE_CONFIG     | Injects contents into `ADCore/ADApp/commonDriverMakefile`. Used to build against additional libraries
PLUGIN_CONFIG       | Injects contents into `ADCore/iocBoot/commonPlugins.cmd`. Used to load additional plugins at IOC startup
AUTOSAVE_CONFIG     | Injects contents into `ADCore/iocBoot/commonPlugin_settings.req`. Used to configure IOC autosave feature
BUILD_FLAG_CONFIG   | Allows for manually setting Area Detector build flags ex. `JPEG_EXTERNAL=YES`.

There is also a directory titiled `os-specific` in the `configure` directory. This contains INSTALL_CONFIG files set with those modules that are known to build on specific OS.

### Usage

For more granular control over the build process, do the following:  

There are only 2 locations with files that need to be edited before running the script. These are the `configure/*` files, and the `scripts/dependencyInstall.sh` file. In the first, edit the install configurations for your installation. In most cases, you may simply change the `MODULE_INSTALL` tag  in the `INSTALL_CONFIG` file for the modules you wish to build and those you don't wish to build, and you must also edit the line
```
INSTALL=/epics
```
to point to the top level directory in which you wish to install EPICS and synApps. The other files in the `configure/` directory contain other configurations, with each one being inserted into a different Area Detector build file. Details can be found in comments in the files themselves.

In the only other file that you must edit (`scripts/dependencyInstall.sh`). In addition, if there are any other dependencies for your build of EPICS and synApps, add them here. For example, to auto-build the ADUVC driver, libuvc must be built, so I added a condition for building and installing libuvc.

From here, you are ready to run the script, and this is done simply by running:
```
./installSynApps.sh
```
from the /scripts directory. Note that you will be prompted for a sudo password to install the dependency packages. Once the script completes, a new directory `autogenerated` is created, and `install.sh` and `uninstall.sh` files are placed within each. Run the appropriate file to uninstall or recompile the packages appropriately. This should simplify building the same sources on multiple operating systems.
